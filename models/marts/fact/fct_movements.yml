models:
  - name: fct_movements
    description: Movements overview data mart.  One row per stock item transaction.
    columns:
      - name: MovementKey
        description: The unique key of the transaction.
        data_tests:
          - not_null
          - unique
      - name: DateKey
        description: The date when the stock item transaction occurred.
        data_tests:
          - not_null
          - relationships:
              arguments:
                field: Date
                to: ref('dim_dates')
      - name: StockItemKey
        description: The unique key of the stock item of the transaction.
        data_tests:
          - not_null
          - relationships:
              arguments:
                to: ref('dim_stock_items')
                field: StockItemKey
      - name: SupplierKey
        description: The unique key of the supplier of the transaction.
        data_tests:
          - not_null
          - relationships:
              arguments:
                to: ref('dim_suppliers')
                field: SupplierKey
      - name: TransactionTypeKey
        description: The unique key of the transaction type of the transaction.
        data_tests:
          - not_null
          - relationships:
              arguments:
                to: ref('dim_transaction_types')
                field: TransactionTypeKey
      - name: WWIStockItemTransactionID
        description: The unique id of the stock item transaction from the source table.
        data_tests:
          - not_null
          - unique
      - name: WWIInvoiceID
        description: The invoice id of the transaction from the source table.
      - name: WWIPurchaseOrderID
        description: The purchase order id of the transaction from the source table.
      - name: Quantity
        description: The quantity of the transaction.
      - name: WWIStockItemID
        description: The unique wwi key of the stock item of the transaction.
      - name: WWICustomerID
        description: The unique wwi key of the customer of the transaction.
      - name: WWISupplierID
        description: The unique wwi key of the supplier of the transaction.
      - name: WWITransactionTypeID
        description: The unique wwi key of the transaction type of the transaction.

semantic_models:
  - name: movements
    defaults:
      agg_time_dimension: DateKey
    description: |
      Movements fact table. This table is tracking all stock item transactions.
    model: ref('fct_movements')
    entities:
      - name: MovementKey
        type: primary
      - name: Date
        type: foreign
        expr: DateKey
      - name: StockItem
        type: foreign
        expr: StockItemKey
      - name: TransactionType
        type: foreign
        expr: TransactionTypeKey
    dimensions:
      - name: DateKey
        expr: date_trunc('day', DateKey)
        type: time
        type_params:
          time_granularity: day